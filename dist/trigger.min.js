/*! trigger - v1.0.0 - 2013-05-07
* Copyright (c) 2013 Nathan Bubna; Licensed MIT, GPL */
(function(t,e){function n(n,i){return n&&"string"!=typeof n?i||(n=r.find(n),i=n.getAttribute(r.attr)):(i=n,n=this===t?e:this),r.all(n,i)}var r={version:"1.0.0",all:function(t,e,n,i){e=e.split(r.splitRE);for(var o=0,u=e.length;u>o&&!r.preventDefault(i||n);o++){var a=r.parse(e[o]);a&&(u>1&&(a.triggers=e),i&&(a.previousEvent=i),n&&(a.originalEvent=n),a.promise=r.promise(t,e,o,n,i),i=r.event(t,a))}return i},promise:function(t,e,n,i,o){return function(u){this.preventDefault(),this.promise=u,u.then(function(){r.all(t,e.slice(n+1).join(" "),i,o)})}},parse:function(t){if(t){var e,n,r,i={trigger:t};if((n=t.indexOf("#",t.indexOf("]")))>0){i.tags=t.substring(n+1).split("#"),t=t.substring(0,n);for(var o=0,u=i.tags.length;u>o;o++)i[i.tags[o]]=!0}return(r=t.indexOf("["))>0&&(i.data=JSON.parse(t.substring(r).replace(/'/g,'"')),t=t.substring(0,r)),(e=t.indexOf(":"))>0&&(i.category=t.substring(0,e),t=t.substring(e+1)),i.type=t,i}},event:function(t,n){var i=e.createEvent("HTMLEvents");i.initEvent(n.type,!0,!0),i.preventDefault||(i.preventDefault=r.preventDefault);for(var o in n)r.prop(o),i[o]=n[o];return t.dispatchEvent(i),i},preventDefault:function(t,e){return t&&!e?t.defaultPrevented||t.returnValue===!1:(t&&t.preventDefault&&t.preventDefault(),(t||this).returnValue=!1,void 0)},listen:function(t){var e=t.target;r[t.type](t,e,e.nodeName.toLowerCase())&&(e=r.find(e))&&(r.all(e,e.getAttribute(r.attr),t),r.preventDefault(t,!r.boxRE.test(e.type)))},find:function(t){return!t||t.getAttribute(r.attr)?t:r.find(t.parentNode)},click:function(t,e,n){return!e.isContentEditable&&!r.noClickRE.test(n)&&("input"!==n||r.buttonRE.test(e.type))},keyup:function(t,e,n){return!(13!==(t.keyCode||t.which)||e.isContentEditable||r.noEnterRE.test(n)||"a"===n&&e.getAttribute("href")||r.buttonRE.test(e.type))},attr:"trigger",splitRE:/ (?![^\[\]]*\])+/g,noClickRE:/^(select|textarea)$/,noEnterRE:/^(textarea|button)$/,buttonRE:/^(submit|button|reset)$/,boxRE:/^(checkbox|radio)$/,on:function(n,r){e.addEventListener?e.addEventListener(n,r):e.attachEvent("on"+n,function(){r(t.event)})},init:function(){r.on("click",r.listen),r.on("keyup",r.listen)},prop:function(t){jQuery&&!r.prop[t]&&(r.prop[t]=!0,jQuery.event.props.push(t))}};n._=r,"undefined"!=typeof module&&module.exports?module.exports=n:t.trigger=n,t.onload=function(){r.init()}})(window,document);